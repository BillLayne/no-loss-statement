<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Statement of No Loss - Bill Layne Insurance</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd', 400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 800: '#1e40af', 900: '#1e3a5f',
                        },
                        emerald: {
                            50: '#ecfdf5', 100: '#d1fae5', 500: '#10b981', 600: '#059669', 700: '#047857',
                        },
                        slate: { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' }
                    },
                    animation: {
                        'pulse-glow': 'pulse-glow 2s infinite',
                        'check-pop': 'check-pop 0.4s ease-out',
                        'fade-up': 'fade-up 0.5s ease-out',
                    },
                    keyframes: {
                        'pulse-glow': {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.5' },
                        },
                        'check-pop': {
                            '0%': { transform: 'scale(0)' },
                            '50%': { transform: 'scale(1.2)' },
                            '100%': { transform: 'scale(1)' },
                        },
                        'fade-up': {
                            '0%': { opacity: '0', transform: 'translateY(16px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                    }
                }
            }
        }
    </script>

    <style>
        body {
            -webkit-tap-highlight-color: transparent;
            background-color: #eff6ff;
            font-size: 17px;
        }

        @media (max-width: 640px) {
            body { font-size: 18px; }
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            min-height: 52px;
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 0.75rem;
            transition: all 0.2s;
            font-size: 1rem;
            color: #1e293b;
        }

        .form-input:focus {
            outline: none;
            border-color: #2563eb;
            background-color: #eff6ff;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
        }

        .form-input::placeholder {
            color: #94a3b8;
        }

        /* Signature Pad */
        #signature-pad {
            touch-action: none;
            background-color: #ffffff;
            background-image: radial-gradient(#dbeafe 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Custom Checkbox — oversized for easy tapping */
        .custom-checkbox {
            appearance: none;
            background-color: #fff;
            margin: 0;
            font: inherit;
            color: currentColor;
            width: 1.75em;
            height: 1.75em;
            min-width: 1.75em;
            border: 2px solid #cbd5e1;
            border-radius: 0.375em;
            display: grid;
            place-content: center;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .custom-checkbox:hover {
            border-color: #2563eb;
            background-color: #eff6ff;
        }

        .custom-checkbox::before {
            content: "";
            width: 0.8em;
            height: 0.8em;
            transform: scale(0);
            transition: 150ms transform ease-in-out;
            box-shadow: inset 1em 1em white;
            transform-origin: center;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }

        .custom-checkbox:checked {
            background-color: #2563eb;
            border-color: #2563eb;
        }

        .custom-checkbox:checked::before {
            transform: scale(1);
        }

        .loading-overlay {
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(8px);
        }

        /* Progress indicator */
        .progress-step {
            transition: all 0.3s ease;
        }
        .progress-step.active .step-dot {
            background-color: #2563eb;
            color: #fff;
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2);
        }
        .progress-step.completed .step-dot {
            background-color: #059669;
            color: #fff;
        }
        .progress-line {
            transition: background-color 0.3s ease;
        }
        .progress-line.completed {
            background-color: #059669;
        }

        /* Section cards */
        .form-section {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        @media (min-width: 640px) {
            .form-section {
                padding: 2rem;
            }
        }

        /* Signature watermark */
        .signature-wrapper {
            position: relative;
        }
        .signature-watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.25rem;
            color: #cbd5e1;
            pointer-events: none;
            font-weight: 600;
            letter-spacing: 0.1em;
            white-space: nowrap;
        }

        /* Success animation */
        @keyframes success-check {
            0% { transform: scale(0) rotate(-45deg); opacity: 0; }
            50% { transform: scale(1.15) rotate(0deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        .success-icon-animate {
            animation: success-check 0.6s ease-out forwards;
        }

        /* Select arrow fix */
        select.form-input {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 8.825L.35 3.175 1.175 2.35 6 7.175 10.825 2.35l.825.825z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.32.0"
  }
}
</script>
</head>
<body class="font-sans text-slate-600 antialiased selection:bg-primary-100 selection:text-primary-900">

    <!-- Header — clean white with blue accent -->
    <header class="bg-white border-b-2 border-primary-500 shadow-sm sticky top-0 z-40">
        <div class="max-w-3xl mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-primary-600 flex items-center justify-center shadow-md">
                    <span class="font-display font-bold text-lg text-white">BL</span>
                </div>
                <div>
                    <h1 class="font-display font-bold text-lg leading-none text-slate-800">Bill Layne Insurance</h1>
                    <p class="text-xs text-primary-600 mt-0.5 font-semibold uppercase tracking-wider">Statement of No Loss</p>
                </div>
            </div>
            <div class="text-right hidden sm:block">
                <a href="tel:3368351993" class="text-sm font-bold text-primary-600 hover:text-primary-700 transition-colors block">(336) 835-1993</a>
                <a href="mailto:Save@BillLayneInsurance.com" class="text-xs text-slate-400 hover:text-primary-600 transition-colors block">Save@BillLayneInsurance.com</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="relative py-6 px-4 sm:px-6 sm:py-10">

        <div class="max-w-3xl mx-auto">

            <!-- Progress Indicator -->
            <div class="flex items-center justify-between mb-8 px-2" id="progressBar">
                <div class="progress-step active flex flex-col items-center flex-1" data-section="section-policy">
                    <div class="step-dot w-9 h-9 rounded-full bg-slate-200 text-slate-500 flex items-center justify-center font-bold text-sm transition-all">1</div>
                    <span class="text-xs mt-1.5 font-semibold text-slate-500">Policy</span>
                </div>
                <div class="progress-line flex-1 h-1 bg-slate-200 rounded-full mx-1 -mt-4"></div>
                <div class="progress-step flex flex-col items-center flex-1" data-section="section-insured">
                    <div class="step-dot w-9 h-9 rounded-full bg-slate-200 text-slate-500 flex items-center justify-center font-bold text-sm transition-all">2</div>
                    <span class="text-xs mt-1.5 font-semibold text-slate-500">Details</span>
                </div>
                <div class="progress-line flex-1 h-1 bg-slate-200 rounded-full mx-1 -mt-4"></div>
                <div class="progress-step flex flex-col items-center flex-1" data-section="section-statement">
                    <div class="step-dot w-9 h-9 rounded-full bg-slate-200 text-slate-500 flex items-center justify-center font-bold text-sm transition-all">3</div>
                    <span class="text-xs mt-1.5 font-semibold text-slate-500">Review</span>
                </div>
                <div class="progress-line flex-1 h-1 bg-slate-200 rounded-full mx-1 -mt-4"></div>
                <div class="progress-step flex flex-col items-center flex-1" data-section="section-signature">
                    <div class="step-dot w-9 h-9 rounded-full bg-slate-200 text-slate-500 flex items-center justify-center font-bold text-sm transition-all">4</div>
                    <span class="text-xs mt-1.5 font-semibold text-slate-500">Sign</span>
                </div>
            </div>

            <form id="noLossForm">

                <!-- Welcome Text -->
                <div class="text-center mb-8">
                    <h2 class="text-2xl sm:text-3xl font-display font-extrabold text-slate-800 mb-2">Reinstatement Request</h2>
                    <p class="text-slate-500 text-base">Complete this form to reinstate your policy. It only takes a few minutes.</p>
                </div>

                <!-- Hidden Fields (Preserved for Backend) -->
                <input type="hidden" id="hiddenAgencyName" name="agencyName" value="Bill Layne Insurance Agency">
                <input type="hidden" id="hiddenAgencyAddress" name="agencyAddress" value="1283 N Bridge St, Elkin NC 28621">
                <input type="hidden" id="hiddenAgencyEmail" name="agencyEmail" value="Save@BillLayneInsurance.com">
                <input type="hidden" id="hiddenAgencyPhone" name="agencyPhone" value="336-835-1993">
                <input type="hidden" id="hiddenAgentName" name="agentName">
                <input type="hidden" id="hiddenAgentEmail" name="agentEmail">

                <!-- SECTION 1: Policy Information -->
                <div class="form-section" id="section-policy">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-10 h-10 rounded-full bg-primary-600 flex items-center justify-center text-white font-bold text-lg shadow-sm">1</div>
                        <div>
                            <h3 class="text-xl font-bold text-slate-800 font-display">Policy Information</h3>
                            <p class="text-sm text-slate-400">Tell us about your policy</p>
                        </div>
                    </div>
                    <hr class="border-slate-100 my-4">

                    <div class="space-y-5">
                        <div class="grid sm:grid-cols-2 gap-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Insurance Company <span class="text-red-500">*</span></label>
                                <select id="insuranceCompany" name="insuranceCompany" required class="form-input appearance-none">
                                    <option value="">Select Company</option>
                                    <option value="Nationwide">Nationwide</option>
                                    <option value="Progressive">Progressive</option>
                                    <option value="National General">National General</option>
                                    <option value="Alamance">Alamance</option>
                                    <option value="Travelers">Travelers</option>
                                    <option value="Foremost">Foremost</option>
                                    <option value="State Farm">State Farm</option>
                                    <option value="Allstate">Allstate</option>
                                    <option value="GEICO">GEICO</option>
                                    <option value="Liberty Mutual">Liberty Mutual</option>
                                    <option value="Farmers">Farmers</option>
                                    <option value="USAA">USAA</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Policy Number <span class="text-red-500">*</span></label>
                                <input type="text" id="policyNumber" name="policyNumber" required class="form-input" placeholder="e.g. 123456789">
                            </div>
                        </div>

                        <div class="grid sm:grid-cols-2 gap-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Policy Type <span class="text-red-500">*</span></label>
                                <select id="policyType" name="policyType" required class="form-input appearance-none">
                                    <option value="">Select Type</option>
                                    <option value="Auto">Auto Insurance</option>
                                    <option value="Home">Homeowners Insurance</option>
                                    <option value="Renters">Renters Insurance</option>
                                    <option value="Motorcycle">Motorcycle Insurance</option>
                                    <option value="RV">RV Insurance</option>
                                    <option value="Commercial Auto">Commercial Auto</option>
                                    <option value="Business">Business Insurance</option>
                                    <option value="Life">Life Insurance</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Total Amount to Reinstate</label>
                                <input type="text" id="amountPaid" name="amountPaid" class="form-input" placeholder="$0.00">
                                <p class="text-xs text-slate-400 mt-1.5 italic">Includes all applicable fees</p>
                            </div>
                        </div>

                        <div class="grid sm:grid-cols-2 gap-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Cancellation / Lapse Date <span class="text-red-500">*</span></label>
                                <input type="date" id="cancellationDate" name="cancellationDate" required class="form-input text-slate-700">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Requested Reinstatement <span class="text-red-500">*</span></label>
                                <input type="date" id="reinstatementDate" name="reinstatementDate" required class="form-input text-slate-700">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 2: Insured Information -->
                <div class="form-section" id="section-insured">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-10 h-10 rounded-full bg-primary-600 flex items-center justify-center text-white font-bold text-lg shadow-sm">2</div>
                        <div>
                            <h3 class="text-xl font-bold text-slate-800 font-display">Your Information</h3>
                            <p class="text-sm text-slate-400">So we can reach you</p>
                        </div>
                    </div>
                    <hr class="border-slate-100 my-4">

                    <div class="space-y-5">
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Full Name <span class="text-red-500">*</span></label>
                            <input type="text" id="insuredName" name="insuredName" required class="form-input" placeholder="Your full legal name">
                        </div>

                        <div class="grid sm:grid-cols-2 gap-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Email Address</label>
                                <input type="email" id="email" name="email" class="form-input" placeholder="you@example.com">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-2">Phone Number <span class="text-red-500">*</span></label>
                                <input type="tel" id="phone" name="phone" required class="form-input" placeholder="(336) 555-1234">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Property / Garaging Address <span class="text-red-500">*</span></label>
                            <input type="text" id="propertyAddress" name="propertyAddress" required class="form-input" placeholder="123 Main St">
                        </div>

                        <div class="grid grid-cols-6 gap-4">
                            <div class="col-span-6 sm:col-span-3">
                                <label class="block text-sm font-bold text-slate-700 mb-2">City <span class="text-red-500">*</span></label>
                                <input type="text" id="city" name="city" required class="form-input">
                            </div>
                            <div class="col-span-3 sm:col-span-1">
                                <label class="block text-sm font-bold text-slate-700 mb-2">State <span class="text-red-500">*</span></label>
                                <select id="state" name="state" required class="form-input px-2">
                                    <option value="NC">NC</option>
                                    <option value="VA">VA</option>
                                    <option value="SC">SC</option>
                                    <option value="TN">TN</option>
                                    <option value="GA">GA</option>
                                </select>
                            </div>
                            <div class="col-span-3 sm:col-span-2">
                                <label class="block text-sm font-bold text-slate-700 mb-2">ZIP Code <span class="text-red-500">*</span></label>
                                <input type="text" id="zipCode" name="zipCode" maxlength="5" pattern="[0-9]{5}" required class="form-input">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 3: Statement of No Loss -->
                <div class="form-section" id="section-statement">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-10 h-10 rounded-full bg-primary-600 flex items-center justify-center text-white font-bold text-lg shadow-sm">3</div>
                        <div>
                            <h3 class="text-xl font-bold text-slate-800 font-display">Statement of No Loss</h3>
                            <p class="text-sm text-slate-400">Please read carefully</p>
                        </div>
                    </div>
                    <hr class="border-slate-100 my-4">

                    <!-- Summary highlight -->
                    <div class="bg-primary-50 border-l-4 border-primary-500 rounded-r-lg p-4 mb-5">
                        <p class="text-primary-800 font-semibold text-sm"><i class="fas fa-info-circle mr-2"></i>By signing below, you confirm that no losses, claims, or accidents occurred during the lapse period of your policy.</p>
                    </div>

                    <!-- Full legal text -->
                    <div class="bg-slate-50 rounded-xl p-5 text-sm leading-relaxed text-slate-600 space-y-4" style="line-height: 1.7;">
                        <p>
                            I, <span id="customerNameDisplay" class="font-bold text-slate-800 bg-yellow-100 px-1.5 py-0.5 rounded">[Customer Name]</span>, state that neither I nor any other person covered by this policy has had a claim or loss or been involved in an accident since the cancellation or expiration of the policy (otherwise known as the "no loss period") wherein this policy, including any and all coverages endorsed upon or made part of the policy may apply.
                        </p>
                        <p>
                            In addition, if this reinstatement is for a personal or commercial auto, motorcycle, or RV policy, I certify that I have disclosed the current garaging location and use of all insured vehicles including if any such vehicle is used to deliver food or goods, to transport people for compensation, or for any other business purpose. I have also disclosed household members who are age 14 or older, and all persons who regularly drive any vehicle insured under this policy.
                        </p>
                        <p>
                            I understand that this insurance company is relying solely upon this Statement of No Loss all of which is material, as an inducement to reinstate my policy with no lapse in coverage. I further understand that if a claim, loss, or accident has occurred during the no loss period, or if I failed to disclose the current garaging location and primary use of all vehicles insured under this policy, all persons who regularly drive these vehicles, and all members of my household who are age 14 or older, the reinstatement is null and void, my policy remains cancelled and no insurance coverage shall be provided.
                        </p>
                        <p>
                            I agree that if my check or other payment for this reinstatement is not honored for any reason, the reinstatement is null and void and no coverage shall exist under this policy. I agree to pay a reinstatement fee and late fee (if applicable) in addition to the premium required to reinstate my policy. My payment will be applied first to the reinstatement and late fee and the remainder to the premium.
                        </p>
                    </div>

                    <!-- Fraud warning -->
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mt-5 flex items-start gap-3">
                        <i class="fas fa-exclamation-triangle text-amber-500 text-lg mt-0.5 flex-shrink-0"></i>
                        <p class="text-amber-800 text-sm font-medium">It is a crime to knowingly provide false, incomplete, or misleading information to an insurance company for the purpose of defrauding the company. Penalties include imprisonment, fines, and denial of insurance benefits.</p>
                    </div>

                    <!-- Acknowledgements -->
                    <div class="space-y-3 mt-6">
                        <label class="flex items-start gap-4 p-4 bg-white border-2 border-slate-200 rounded-xl cursor-pointer hover:border-primary-400 hover:bg-primary-50/30 transition-all shadow-sm">
                            <input type="checkbox" id="noLossConfirmation" name="noLossConfirmation" required class="custom-checkbox mt-0.5 flex-shrink-0">
                            <span class="text-base font-medium text-slate-700 leading-relaxed">I have read, understand, and agree to all the statements above. I confirm that <strong class="text-slate-900">NO LOSS</strong>, damage, or claim has occurred during the lapse period.</span>
                        </label>

                        <div id="dmvContainer" class="hidden">
                            <label class="flex items-start gap-4 p-4 bg-white border-2 border-slate-200 rounded-xl cursor-pointer hover:border-primary-400 hover:bg-primary-50/30 transition-all shadow-sm">
                                <input type="checkbox" id="dmvAcknowledgement" name="dmvAcknowledgement" class="custom-checkbox mt-0.5 flex-shrink-0">
                                <span class="text-base font-medium text-slate-700">I acknowledge that the DMV may be notified of this policy reinstatement.</span>
                            </label>
                        </div>

                        <div id="mortgageContainer" class="hidden">
                            <label class="flex items-start gap-4 p-4 bg-white border-2 border-slate-200 rounded-xl cursor-pointer hover:border-primary-400 hover:bg-primary-50/30 transition-all shadow-sm">
                                <input type="checkbox" id="mortgageAcknowledgement" name="mortgageAcknowledgement" class="custom-checkbox mt-0.5 flex-shrink-0">
                                <span class="text-base font-medium text-slate-700">I acknowledge that my mortgage company may be notified of this policy reinstatement.</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- SECTION 4: Signature -->
                <div class="form-section" id="section-signature">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-10 h-10 rounded-full bg-emerald-600 flex items-center justify-center text-white font-bold text-lg shadow-sm">4</div>
                        <div>
                            <h3 class="text-xl font-bold text-slate-800 font-display">Your Signature</h3>
                            <p class="text-sm text-slate-400">Sign below to confirm</p>
                        </div>
                    </div>
                    <hr class="border-slate-100 my-4">

                    <p class="text-base text-slate-600 mb-3 font-medium"><i class="fas fa-hand-pointer text-primary-500 mr-2"></i>Use your finger or mouse to sign in the box below <span class="text-red-500">*</span></p>
                    <div class="signature-wrapper border-2 border-dashed border-primary-300 rounded-xl overflow-hidden bg-white cursor-crosshair shadow-inner relative group hover:border-primary-500 transition-colors" style="height: 220px;">
                        <canvas id="signature-pad" class="w-full h-full"></canvas>
                        <div class="signature-watermark"><i class="fas fa-signature mr-2"></i>Sign Here</div>
                        <div class="absolute top-3 right-3 opacity-70 group-hover:opacity-100 transition-opacity">
                            <button type="button" onclick="clearSignature()" class="text-sm bg-red-50 hover:bg-red-100 text-red-600 px-4 py-2 rounded-lg transition-colors border border-red-200 font-semibold">
                                <i class="fas fa-eraser mr-1"></i> Clear
                            </button>
                        </div>
                    </div>
                    <input type="hidden" id="signature" name="signature">
                </div>

                <!-- Error Message -->
                <div id="errorMessage" class="hidden bg-red-50 text-red-700 px-5 py-4 rounded-xl mb-6 text-base font-medium border border-red-200 flex items-center gap-3">
                    <i class="fas fa-exclamation-circle text-red-500 text-xl flex-shrink-0"></i>
                    <span></span>
                </div>

                <!-- Submit Button — big, green, unmissable -->
                <button type="submit" id="submitBtn" class="w-full bg-emerald-600 hover:bg-emerald-700 active:bg-emerald-800 text-white font-bold py-5 rounded-xl shadow-lg shadow-emerald-600/30 transition-all hover:shadow-xl hover:shadow-emerald-600/40 active:scale-[0.98] text-xl flex items-center justify-center gap-3 mt-4">
                    <i class="fas fa-paper-plane text-lg"></i>
                    <span>Submit My Statement</span>
                </button>

                <p class="text-center text-xs text-slate-400 mt-3"><i class="fas fa-lock mr-1"></i> Your information is transmitted securely and encrypted.</p>

            </form>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 py-6 mt-10">
        <div class="max-w-3xl mx-auto px-4 text-center">
            <img src="https://i.imgur.com/oixB60n.png" alt="Bill Layne Insurance" class="h-10 mx-auto mb-3 opacity-80">
            <p class="text-sm font-semibold text-slate-600">Bill Layne Insurance Agency</p>
            <p class="text-xs text-slate-400 mt-1">1283 N Bridge St, Elkin NC 28621 &bull; (336) 835-1993</p>
            <div class="mt-4 pt-4 border-t border-slate-100 text-[10px] text-slate-300 uppercase tracking-widest">
                Powered by MyNoLossForm.com
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div id="loading" class="hidden fixed inset-0 z-50 flex items-center justify-center loading-overlay">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full mx-4 text-center border border-slate-100">
            <div class="w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-6"></div>
            <h3 class="text-xl font-bold text-slate-800 mb-2">Processing...</h3>
            <p class="text-slate-500 text-sm mb-4">Securely transmitting your signature.</p>
            <div class="text-xs font-semibold text-amber-700 bg-amber-50 py-2 px-4 rounded-full inline-block border border-amber-200">
                <i class="fas fa-lock mr-1"></i> Do not close this window
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModalOverlay" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-slate-900/80 backdrop-blur-sm px-4">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center shadow-2xl animate-fade-up">
            <div class="w-24 h-24 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6 success-icon-animate">
                <i class="fas fa-check text-5xl text-emerald-600"></i>
            </div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2 font-display">You're All Set!</h2>
            <p class="text-slate-500 mb-6">Your Statement of No Loss has been received and processed.</p>

            <div class="bg-primary-50 border border-primary-200 rounded-xl p-4 mb-6">
                <p class="text-xs text-primary-500 uppercase tracking-wider mb-1 font-semibold">Confirmation Number</p>
                <p id="confirmNumber" class="text-2xl font-mono font-bold text-primary-700 select-all"></p>
            </div>

            <div class="space-y-3 text-base text-slate-600 mb-8 text-left px-2">
                <p class="flex items-center gap-3"><span class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center flex-shrink-0"><i class="fas fa-envelope text-emerald-600 text-sm"></i></span> Email confirmation sent</p>
                <p class="flex items-center gap-3"><span class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center flex-shrink-0"><i class="fas fa-sms text-emerald-600 text-sm"></i></span> SMS confirmation sent</p>
                <p class="flex items-center gap-3"><span class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center flex-shrink-0"><i class="fas fa-file-pdf text-emerald-600 text-sm"></i></span> PDF copy sent to agency</p>
            </div>

            <button onclick="closeSuccessModal()" class="w-full bg-primary-600 text-white font-bold py-4 rounded-xl hover:bg-primary-700 transition-colors shadow-lg text-lg">
                Done
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script>
        // YOUR GOOGLE APPS SCRIPT URL - PRESERVED
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxD6j-pGmC13_X5GTUfIpJPg-HJXIMnzcaUmvo7rEBwd97Cx6alEabi30YJp5S6fqUyEg/exec';

        let signaturePad;

        // --- Helper Functions ---
        function getDeviceInfo() {
            const userAgent = navigator.userAgent;
            let deviceType = 'Desktop';
            let os = 'Unknown OS';
            let browser = 'Unknown Browser';

            if (/Mobile|Android|iPhone|iPad/i.test(userAgent)) deviceType = /iPad/i.test(userAgent) ? 'Tablet' : 'Mobile';
            if (userAgent.indexOf('Win') !== -1) os = 'Windows';
            else if (userAgent.indexOf('Mac') !== -1) os = 'MacOS';
            else if (userAgent.indexOf('Linux') !== -1) os = 'Linux';
            else if (userAgent.indexOf('Android') !== -1) os = 'Android';
            else if (/iPhone|iPad|iPod/.test(userAgent)) os = 'iOS';

            if (userAgent.indexOf('Chrome') !== -1 && userAgent.indexOf('Edg') === -1) browser = 'Chrome';
            else if (userAgent.indexOf('Safari') !== -1 && userAgent.indexOf('Chrome') === -1) browser = 'Safari';
            else if (userAgent.indexOf('Firefox') !== -1) browser = 'Firefox';
            else if (userAgent.indexOf('Edg') !== -1) browser = 'Edge';

            return `${deviceType} - ${os} - ${browser}`.trim();
        }

        function generateBrowserFingerprint() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('fingerprint', 2, 2);
            let fingerprint = canvas.toDataURL().substring(0, 50).replace(/[^a-zA-Z0-9]/g, '');
            const screenData = `${screen.width}x${screen.height}x${screen.colorDepth}`;
            const plugins = navigator.plugins.length;
            return `FP-${fingerprint}-${screenData.replace(/[^0-9]/g, '')}-${plugins}`.substring(0, 50);
        }

        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.log('Could not fetch IP:', error);
                return 'Unable to capture';
            }
        }

        // --- Initialization ---
        window.addEventListener('DOMContentLoaded', async function() {
            const urlParams = new URLSearchParams(window.location.search);

            // Pre-fill form fields
            const fieldMappings = {
                'insuredName': 'insuredName', 'email': 'email', 'phone': 'phone',
                'propertyAddress': 'propertyAddress', 'city': 'city', 'state': 'state', 'zipCode': 'zipCode',
                'insuranceCompany': 'insuranceCompany', 'policyNumber': 'policyNumber',
                'policyType': 'policyType', 'amountPaid': 'amountPaid',
                'cancellationDate': 'cancellationDate', 'reinstatementDate': 'reinstatementDate'
            };

            Object.keys(fieldMappings).forEach(param => {
                const value = urlParams.get(param);
                if (value) {
                    const element = document.getElementById(fieldMappings[param]);
                    if (element) element.value = decodeURIComponent(value);
                }
            });

            // Agent info
            const agentName = urlParams.get('agentName');
            const agentEmail = urlParams.get('agentEmail');
            if (agentName) document.getElementById('hiddenAgentName').value = agentName;
            if (agentEmail) document.getElementById('hiddenAgentEmail').value = agentEmail;

            // Policy Type Logic
            const policyTypeElement = document.getElementById('policyType');
            policyTypeElement.addEventListener('change', function() {
                const policyType = this.value;
                document.getElementById('dmvContainer').style.display =
                    ['Auto', 'Motorcycle', 'RV', 'Commercial Auto'].includes(policyType) ? 'block' : 'none';
                document.getElementById('mortgageContainer').style.display =
                    (policyType === 'Home') ? 'block' : 'none';
            });

            if (policyTypeElement.value) policyTypeElement.dispatchEvent(new Event('change'));

            // Init Signature Pad
            initSignaturePad();

            // Update Customer Name in Text
            updateCustomerNameDisplay();
            document.getElementById('insuredName').addEventListener('input', updateCustomerNameDisplay);

            // Pre-fetch IP
            window.userIPAddress = await getIPAddress();

            // --- Progress Indicator (scroll-based) ---
            const sections = document.querySelectorAll('.form-section');
            const steps = document.querySelectorAll('.progress-step');
            const lines = document.querySelectorAll('.progress-line');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const sectionId = entry.target.id;
                    const stepIndex = Array.from(sections).indexOf(entry.target);

                    if (entry.isIntersecting && entry.intersectionRatio > 0.2) {
                        // Mark current and previous steps
                        steps.forEach((step, i) => {
                            step.classList.remove('active', 'completed');
                            if (i < stepIndex) step.classList.add('completed');
                            else if (i === stepIndex) step.classList.add('active');
                        });
                        lines.forEach((line, i) => {
                            line.classList.toggle('completed', i < stepIndex);
                        });
                    }
                });
            }, { threshold: [0.2, 0.5], rootMargin: '-80px 0px -40% 0px' });

            sections.forEach(section => observer.observe(section));
        });

        function updateCustomerNameDisplay() {
            const name = document.getElementById('insuredName').value || '[Customer Name]';
            document.getElementById('customerNameDisplay').textContent = name;
        }

        function initSignaturePad() {
            const canvas = document.getElementById('signature-pad');
            signaturePad = new SignaturePad(canvas, {
                backgroundColor: 'rgb(255, 255, 255)',
                penColor: 'rgb(15, 23, 42)' // Slate-900 color for pen
            });
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
        }

        function resizeCanvas() {
            const canvas = document.getElementById('signature-pad');
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            canvas.width = canvas.offsetWidth * ratio;
            canvas.height = canvas.offsetHeight * ratio;
            canvas.getContext('2d').scale(ratio, ratio);
            if (signaturePad) signaturePad.clear();
        }

        window.clearSignature = function() {
            signaturePad.clear();
        }

        window.closeSuccessModal = function() {
            document.getElementById('successModalOverlay').classList.add('hidden');
            document.getElementById('successModalOverlay').classList.remove('flex');
        }

        // --- Form Submission ---
        document.getElementById('noLossForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            if (!document.getElementById('noLossConfirmation').checked) {
                alert('Please check the box to confirm you agree to the Statement.');
                return;
            }

            if (signaturePad.isEmpty()) {
                alert('Please sign the form before submitting.');
                return;
            }

            document.getElementById('signature').value = signaturePad.toDataURL();

            // Show loading
            const loading = document.getElementById('loading');
            loading.classList.remove('hidden');
            loading.classList.add('flex');

            document.getElementById('submitBtn').disabled = true;
            document.getElementById('errorMessage').classList.add('hidden');

            const formData = new FormData(this);
            const data = Object.fromEntries(formData);

            // Checkbox logic
            data.dmvAcknowledgement = document.getElementById('dmvAcknowledgement').checked ? 'Yes' : '';
            data.mortgageAcknowledgement = document.getElementById('mortgageAcknowledgement').checked ? 'Yes' : '';

            // Metadata generation
            const confirmationNumber = 'NOL-' + new Date().toISOString().slice(0,10).replace(/-/g,'') + '-' + Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            const sessionId = 'NOL-SESSION-' + Date.now() + '-' + Math.random().toString(36).substring(2, 9);

            data.confirmationNumber = confirmationNumber;
            data.sessionId = sessionId;
            data.browserFingerprint = generateBrowserFingerprint();
            data.deviceInfo = getDeviceInfo();
            data.screenResolution = `${window.screen.width}x${window.screen.height}`;
            data.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            data.signatureDateTime = new Date().toLocaleString();
            data.signatureTime = new Date().toLocaleTimeString();
            data.userAgent = navigator.userAgent;
            data.formVersion = 'v5.0-BillLayne-Modern';
            data.submissionMethod = 'Online Portal - MyNoLossForm';
            data.ipAddress = window.userIPAddress || 'Unable to capture';

            data.signatureMetadata = JSON.stringify({
                cookiesEnabled: navigator.cookieEnabled,
                onlineStatus: navigator.onLine,
                platform: navigator.platform,
                colorDepth: screen.colorDepth,
                timezoneOffset: new Date().getTimezoneOffset()
            });

            data.signatureUrl = document.getElementById('signature').value;
            data.submittedAt = new Date().toISOString();

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                document.getElementById('confirmNumber').textContent = confirmationNumber;
                const successModal = document.getElementById('successModalOverlay');
                successModal.classList.remove('hidden');
                successModal.classList.add('flex');

                this.reset();
                signaturePad.clear();
                updateCustomerNameDisplay();

            } catch (error) {
                console.error('Error:', error);
                const errorEl = document.getElementById('errorMessage');
                errorEl.textContent = 'Failed to submit form. Please try again or contact the agency.';
                errorEl.classList.remove('hidden');
            } finally {
                loading.classList.remove('flex');
                loading.classList.add('hidden');
                document.getElementById('submitBtn').disabled = false;
            }
        });

        // Formatting Helpers
        document.getElementById('phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 0) {
                if (value.length <= 3) value = '(' + value;
                else if (value.length <= 6) value = '(' + value.slice(0, 3) + ') ' + value.slice(3);
                else value = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + '-' + value.slice(6, 10);
            }
            e.target.value = value;
        });

        document.getElementById('amountPaid').addEventListener('input', function(e) {
            let value = e.target.value.replace(/[^\d.]/g, '');
            if (value && !e.target.value.startsWith('$')) e.target.value = '$' + value;
        });

        document.getElementById('zipCode').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '').slice(0, 5);
        });
    </script>
</body>
</html>
